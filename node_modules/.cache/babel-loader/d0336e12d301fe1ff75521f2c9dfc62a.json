{"ast":null,"code":"import * as tslib_1 from \"tslib\";\nimport { WebPlugin } from './index';\nimport { CameraResultType } from '../core-plugin-definitions'; //import '@ionic/pwa-elements';\n\nvar CameraPluginWeb =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(CameraPluginWeb, _super);\n\n  function CameraPluginWeb() {\n    return _super.call(this, {\n      name: 'Camera',\n      platforms: ['web']\n    }) || this;\n  }\n\n  CameraPluginWeb.prototype.getPhoto = function (options) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return tslib_1.__generator(this, function (_a) {\n        options;\n        return [2\n        /*return*/\n        , new Promise(function (resolve, reject) {\n          return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var cameraModal;\n\n            var _this = this;\n\n            return tslib_1.__generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  cameraModal = document.createElement('pwa-camera-modal');\n                  document.body.appendChild(cameraModal);\n                  return [4\n                  /*yield*/\n                  , cameraModal.componentOnReady()];\n\n                case 1:\n                  _a.sent();\n\n                  cameraModal.addEventListener('onPhoto', function (e) {\n                    return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                      var photo, _a;\n\n                      return tslib_1.__generator(this, function (_b) {\n                        switch (_b.label) {\n                          case 0:\n                            photo = e.detail;\n                            if (!(photo === null)) return [3\n                            /*break*/\n                            , 1];\n                            reject('User cancelled photos app');\n                            return [3\n                            /*break*/\n                            , 4];\n\n                          case 1:\n                            if (!(photo instanceof Error)) return [3\n                            /*break*/\n                            , 2];\n                            reject(photo.message);\n                            return [3\n                            /*break*/\n                            , 4];\n\n                          case 2:\n                            _a = resolve;\n                            return [4\n                            /*yield*/\n                            , this._getCameraPhoto(photo, options)];\n\n                          case 3:\n                            _a.apply(void 0, [_b.sent()]);\n\n                            _b.label = 4;\n\n                          case 4:\n                            cameraModal.dismiss();\n                            document.body.removeChild(cameraModal);\n                            return [2\n                            /*return*/\n                            ];\n                        }\n                      });\n                    });\n                  });\n                  cameraModal.present();\n                  return [2\n                  /*return*/\n                  ];\n              }\n            });\n          });\n        })];\n      });\n    });\n  };\n\n  CameraPluginWeb.prototype._getCameraPhoto = function (photo, options) {\n    return new Promise(function (resolve, reject) {\n      var reader = new FileReader();\n      var format = photo.type.split('/')[1];\n\n      if (options.resultType == CameraResultType.Uri) {\n        resolve({\n          webPath: URL.createObjectURL(photo),\n          format: format\n        });\n      } else {\n        reader.readAsDataURL(photo);\n\n        reader.onloadend = function () {\n          var r = reader.result;\n\n          if (options.resultType == CameraResultType.DataUrl) {\n            resolve({\n              dataUrl: r,\n              format: format\n            });\n          } else {\n            resolve({\n              base64String: r.split(',')[1],\n              format: format\n            });\n          }\n        };\n\n        reader.onerror = function (e) {\n          reject(e);\n        };\n      }\n    });\n  };\n\n  return CameraPluginWeb;\n}(WebPlugin);\n\nexport { CameraPluginWeb };\nvar Camera = new CameraPluginWeb();\nexport { Camera };","map":{"version":3,"sources":["../../../src/web/camera.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import * as tslib_1 from \"tslib\";\nimport { WebPlugin } from './index';\nimport { CameraResultType } from '../core-plugin-definitions';\n//import '@ionic/pwa-elements';\nvar CameraPluginWeb = /** @class */ (function (_super) {\n    tslib_1.__extends(CameraPluginWeb, _super);\n    function CameraPluginWeb() {\n        return _super.call(this, {\n            name: 'Camera',\n            platforms: ['web']\n        }) || this;\n    }\n    CameraPluginWeb.prototype.getPhoto = function (options) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                options;\n                return [2 /*return*/, new Promise(function (resolve, reject) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                        var cameraModal;\n                        var _this = this;\n                        return tslib_1.__generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0:\n                                    cameraModal = document.createElement('pwa-camera-modal');\n                                    document.body.appendChild(cameraModal);\n                                    return [4 /*yield*/, cameraModal.componentOnReady()];\n                                case 1:\n                                    _a.sent();\n                                    cameraModal.addEventListener('onPhoto', function (e) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                                        var photo, _a;\n                                        return tslib_1.__generator(this, function (_b) {\n                                            switch (_b.label) {\n                                                case 0:\n                                                    photo = e.detail;\n                                                    if (!(photo === null)) return [3 /*break*/, 1];\n                                                    reject('User cancelled photos app');\n                                                    return [3 /*break*/, 4];\n                                                case 1:\n                                                    if (!(photo instanceof Error)) return [3 /*break*/, 2];\n                                                    reject(photo.message);\n                                                    return [3 /*break*/, 4];\n                                                case 2:\n                                                    _a = resolve;\n                                                    return [4 /*yield*/, this._getCameraPhoto(photo, options)];\n                                                case 3:\n                                                    _a.apply(void 0, [_b.sent()]);\n                                                    _b.label = 4;\n                                                case 4:\n                                                    cameraModal.dismiss();\n                                                    document.body.removeChild(cameraModal);\n                                                    return [2 /*return*/];\n                                            }\n                                        });\n                                    }); });\n                                    cameraModal.present();\n                                    return [2 /*return*/];\n                            }\n                        });\n                    }); })];\n            });\n        });\n    };\n    CameraPluginWeb.prototype._getCameraPhoto = function (photo, options) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            var format = photo.type.split('/')[1];\n            if (options.resultType == CameraResultType.Uri) {\n                resolve({\n                    webPath: URL.createObjectURL(photo),\n                    format: format\n                });\n            }\n            else {\n                reader.readAsDataURL(photo);\n                reader.onloadend = function () {\n                    var r = reader.result;\n                    if (options.resultType == CameraResultType.DataUrl) {\n                        resolve({\n                            dataUrl: r,\n                            format: format\n                        });\n                    }\n                    else {\n                        resolve({\n                            base64String: r.split(',')[1],\n                            format: format\n                        });\n                    }\n                };\n                reader.onerror = function (e) {\n                    reject(e);\n                };\n            }\n        });\n    };\n    return CameraPluginWeb;\n}(WebPlugin));\nexport { CameraPluginWeb };\nvar Camera = new CameraPluginWeb();\nexport { Camera };\n//# sourceMappingURL=camera.js.map"]},"metadata":{},"sourceType":"module"}