{"ast":null,"code":"import _regeneratorRuntime from \"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/fazna/cleanit/src/pages/BookSlot.tsx\";\n\nimport React, { useEffect, useState } from 'react';\nimport { IonHeader, IonDatetime, IonToolbar, IonTitle, IonContent, IonPage, IonButtons, IonMenuButton, IonRow, IonCol, IonButton, IonList, IonItem, IonLabel, IonText, IonSelect, IonSelectOption } from '@ionic/react';\nimport './Login.scss';\nimport { setIsLoggedIn, setUsername } from '../data/user/user.actions';\nimport { connect } from '../data/connect';\nimport { Plugins, CameraResultType, CameraSource } from '@capacitor/core';\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport { getUserData } from '../data/dataApi';\nimport { Modal } from './Modal';\nvar Camera = Plugins.Camera,\n    Dialog = Plugins.Dialog,\n    Toast = Plugins.Toast;\n\nvar BookSlot = function BookSlot(_ref) {\n  var setIsLoggedIn = _ref.setIsLoggedIn,\n      history = _ref.history,\n      setUsernameAction = _ref.setUsername;\n  var sampleimageurl = 'https://img-getpocket.cdn.mozilla.net/296x148/filters:format(jpeg):quality(60):no_upscale():strip_exif()/https%3A%2F%2Fpocket-image-cache.com%2F1200x%2Ffilters%3Ano_upscale()%3Aformat(jpg)%3Aextract_cover()%2Fhttps%253A%252F%252Fpocket-syndicated-images.s3.amazonaws.com%252Farticles%252F5204%252F1595959480_GettyImages-129164329.jpgcrop.jpg22.jpg';\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      username = _useState2[0],\n      setUsername = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      time = _useState4[0],\n      setTime = _useState4[1];\n\n  var _useState5 = useState('2021-06-15'),\n      _useState6 = _slicedToArray(_useState5, 2),\n      date = _useState6[0],\n      setDate = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      coord = _useState8[0],\n      setCoord = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      location = _useState10[0],\n      setLocation = _useState10[1];\n\n  var _useState11 = useState(null),\n      _useState12 = _slicedToArray(_useState11, 2),\n      image = _useState12[0],\n      setImage = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      gpsEnable = _useState14[0],\n      setGpsEnabled = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      formSubmitted = _useState16[0],\n      setFormSubmitted = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      usernameError = _useState18[0],\n      setUsernameError = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      passwordError = _useState20[0],\n      setPasswordError = _useState20[1];\n\n  var _useState21 = useState(false),\n      _useState22 = _slicedToArray(_useState21, 2),\n      loading = _useState22[0],\n      setLoading = _useState22[1];\n\n  var _useState23 = useState(''),\n      _useState24 = _slicedToArray(_useState23, 2),\n      phone = _useState24[0],\n      setPhone = _useState24[1];\n\n  var _useState25 = useState(false),\n      _useState26 = _slicedToArray(_useState25, 2),\n      showModal = _useState26[0],\n      setShowModal = _useState26[1];\n\n  var _ref2,\n      _ref3 = _slicedToArray(_ref2, 2),\n      query = _ref3[0],\n      se = _ref3[1];\n\n  useEffect(function () {\n    function getData() {\n      return _getData.apply(this, arguments);\n    }\n\n    function _getData() {\n      _getData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getUserData();\n\n              case 2:\n                res = _context.sent;\n                setPhone(res.username);\n                console.log(res);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _getData.apply(this, arguments);\n    }\n\n    getData();\n  }, [getUserData]);\n\n  function alert() {\n    return _alert.apply(this, arguments);\n  }\n\n  function _alert() {\n    _alert = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.prev = 0;\n              _context6.next = 3;\n              return Dialog.alert({\n                title: 'Successfully Updated',\n                message: \"You have selected \".concat(time, \" on \").concat(date)\n              });\n\n            case 3:\n              _context6.next = 10;\n              break;\n\n            case 5:\n              _context6.prev = 5;\n              _context6.t0 = _context6[\"catch\"](0);\n              console.log(_context6.t0);\n              _context6.next = 10;\n              return Toast.show({\n                text: \"You have selected \".concat(time, \" on \").concat(date)\n              });\n\n            case 10:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, null, [[0, 5]]);\n    }));\n    return _alert.apply(this, arguments);\n  }\n\n  var timeslots = ['10-12pm', '2pm-4pm', '6pm-7pm'];\n  useEffect(function () {\n    console.log(date);\n    alert();\n  }, [date]);\n\n  var login = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var db, data, docRef;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setLoading(true);\n              e.preventDefault(); //ADD DATA TO DB\n\n              db = firebase.firestore();\n              data = {\n                date: '12-10-19',\n                image: image,\n                time: time\n              };\n\n              try {\n                docRef = db.collection('waste_collection_details').doc(phone);\n                docRef.get().then( /*#__PURE__*/function () {\n                  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(doc) {\n                    var doc_data, bookings, res, _res;\n\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            if (!doc.exists) {\n                              _context2.next = 8;\n                              break;\n                            }\n\n                            doc_data = doc.data();\n                            bookings = doc_data.bookings.push(data);\n                            _context2.next = 5;\n                            return db.collection('waste_collection_details').doc(phone).update({\n                              bookings: bookings\n                            });\n\n                          case 5:\n                            res = _context2.sent;\n                            _context2.next = 11;\n                            break;\n\n                          case 8:\n                            _context2.next = 10;\n                            return db.collection('waste_collection_details').doc(phone).set({\n                              bookings: [data]\n                            });\n\n                          case 10:\n                            _res = _context2.sent;\n\n                          case 11:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  }));\n\n                  return function (_x2) {\n                    return _ref5.apply(this, arguments);\n                  };\n                }()); // alert()\n\n                setShowModal(true);\n              } catch (e) {\n                console.log(e);\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function login(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var getPicture = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              res = addImage(CameraSource.Photos);\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function getPicture() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var addImage = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(source) {\n      var images;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              _context5.next = 3;\n              return Camera.getPhoto({\n                quality: 60,\n                allowEditing: true,\n                resultType: CameraResultType.DataUrl,\n                source: source\n              });\n\n            case 3:\n              images = _context5.sent;\n\n              if (images) {\n                setImage(images);\n              }\n\n              _context5.next = 10;\n              break;\n\n            case 7:\n              _context5.prev = 7;\n              _context5.t0 = _context5[\"catch\"](0);\n              console.log(_context5.t0);\n\n            case 10:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[0, 7]]);\n    }));\n\n    return function addImage(_x3) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(IonPage, {\n    id: \"details-page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonHeader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IonToolbar, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonButtons, {\n    slot: \"start\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonMenuButton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(IonTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, \"Book Your Slot\"))), /*#__PURE__*/React.createElement(IonContent, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    noValidate: true,\n    onSubmit: login,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonList, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 15\n    }\n  }, \"Select Date\"), /*#__PURE__*/React.createElement(IonDatetime, {\n    min: '2021-06-15',\n    max: '2025-01-01',\n    value: date,\n    onIonChange: function onIonChange(e) {\n      return setDate(e.detail.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  })), formSubmitted && usernameError && /*#__PURE__*/React.createElement(IonText, {\n    color: \"danger\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 48\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"ion-padding-start\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }, \"Date is required\")), /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 15\n    }\n  }, \"Time\"), /*#__PURE__*/React.createElement(IonSelect, {\n    value: time,\n    placeholder: \"Select One\",\n    onIonChange: function onIonChange(e) {\n      return setTime(e.detail.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 15\n    }\n  }, timeslots.map(function (i) {\n    return /*#__PURE__*/React.createElement(IonSelectOption, {\n      value: i,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 17\n      }\n    }, i);\n  }))), /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 15\n    }\n  }, \"Picture\"), /*#__PURE__*/React.createElement(IonButton, {\n    style: {\n      borderRadius: 0\n    },\n    color: \"primary\",\n    onClick: function onClick() {\n      getPicture();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 15\n    }\n  }, \"Upload Picture\")), image !== null && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      margin: '20px'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    style: {\n      marginTop: '10px'\n    },\n    src: image.dataUrl,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(IonRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    disabled: loading,\n    type: \"submit\",\n    expand: \"block\",\n    onClick: function onClick(e) {\n      return login(e);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 15\n    }\n  }, \"Submit\"))), /*#__PURE__*/React.createElement(Modal, {\n    openModal: showModal,\n    text: \"You have selected \".concat(time, \" on \").concat(date),\n    closeModal: function closeModal() {\n      return history.push('/dashboard', {\n        direction: 'none'\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default connect({\n  mapDispatchToProps: {\n    setIsLoggedIn: setIsLoggedIn,\n    setUsername: setUsername,\n    getUserData: getUserData\n  },\n  component: BookSlot\n});","map":{"version":3,"sources":["/home/fazna/cleanit/src/pages/BookSlot.tsx"],"names":["React","useEffect","useState","IonHeader","IonDatetime","IonToolbar","IonTitle","IonContent","IonPage","IonButtons","IonMenuButton","IonRow","IonCol","IonButton","IonList","IonItem","IonLabel","IonText","IonSelect","IonSelectOption","setIsLoggedIn","setUsername","connect","Plugins","CameraResultType","CameraSource","firebase","getUserData","Modal","Camera","Dialog","Toast","BookSlot","history","setUsernameAction","sampleimageurl","username","time","setTime","date","setDate","coord","setCoord","location","setLocation","image","setImage","gpsEnable","setGpsEnabled","formSubmitted","setFormSubmitted","usernameError","setUsernameError","passwordError","setPasswordError","loading","setLoading","phone","setPhone","showModal","setShowModal","query","se","getData","res","console","log","alert","title","message","show","text","timeslots","login","e","preventDefault","db","firestore","data","docRef","collection","doc","get","then","exists","doc_data","bookings","push","update","set","getPicture","addImage","Photos","source","getPhoto","quality","allowEditing","resultType","DataUrl","images","detail","value","map","i","borderRadius","margin","marginTop","dataUrl","direction","mapDispatchToProps","component"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { IonHeader,IonDatetime, IonToolbar, IonTitle, IonContent, IonPage, IonButtons, IonMenuButton, IonRow, IonCol, IonButton, IonList, IonItem, IonLabel, IonInput, IonText, IonTextarea, IonToggle, IonSelect, IonItemOption, IonSelectOption, IonIcon } from '@ionic/react';\nimport './Login.scss';\nimport { setIsLoggedIn, setUsername } from '../data/user/user.actions';\nimport { connect } from '../data/connect';\nimport { RouteComponentProps } from 'react-router';\nimport { Plugins, CameraResultType, CameraSource ,CameraPhoto} from '@capacitor/core';\nimport firebase from 'firebase/app'\nimport 'firebase/firestore';\nimport { getUserData } from '../data/dataApi';\nimport { Modal } from './Modal';\n\nconst { Camera ,Dialog,Toast} = Plugins;\ninterface OwnProps extends RouteComponentProps {}\n\ninterface DispatchProps {\n  setIsLoggedIn: typeof setIsLoggedIn;\n  setUsername: typeof setUsername;\n  getUserData: typeof getUserData;\n}\n// const db = firebase.firestore()\ninterface LoginProps extends OwnProps,  DispatchProps { }\ninterface PhotoData extends CameraPhoto {}\nconst BookSlot: React.FC<LoginProps> = ({setIsLoggedIn, history, setUsername: setUsernameAction}) => {\n  const  sampleimageurl = 'https://img-getpocket.cdn.mozilla.net/296x148/filters:format(jpeg):quality(60):no_upscale():strip_exif()/https%3A%2F%2Fpocket-image-cache.com%2F1200x%2Ffilters%3Ano_upscale()%3Aformat(jpg)%3Aextract_cover()%2Fhttps%253A%252F%252Fpocket-syndicated-images.s3.amazonaws.com%252Farticles%252F5204%252F1595959480_GettyImages-129164329.jpgcrop.jpg22.jpg'\n  const [username, setUsername] = useState('');\n  const [time, setTime] = useState('');\n  const [date,setDate] = useState('2021-06-15');\n  const [coord,setCoord] = useState('');\n  const [location,setLocation] = useState('');\n  const [image,setImage] = useState<PhotoData | null>(null)\n  const [gpsEnable,setGpsEnabled] = useState(false)\n  const [formSubmitted, setFormSubmitted] = useState(false);\n  const [usernameError, setUsernameError] = useState(false);\n  const [passwordError, setPasswordError] = useState(false);\n  const [loading,setLoading] = useState(false)\n  const [phone,setPhone] = useState('')\n  const [showModal,setShowModal] = useState(false)\n  const [query,se]\n  useEffect(()=>{\n    async function getData() {\n      let res = await getUserData()\n      setPhone(res.username)\n      console.log(res)\n     }\n    getData()\n  },[getUserData])\n\n  async function alert(){\n   try{\n    await Dialog.alert({\n      title: 'Successfully Updated',\n      message: `You have selected ${time} on ${date}`,\n    });\n   }catch(e){\n     console.log(e)\n     await Toast.show({\n      text: `You have selected ${time} on ${date}`\n     })\n   }\n  }\n\nconst timeslots = ['10-12pm','2pm-4pm','6pm-7pm']\nuseEffect(()=>{\n  console.log(date)\n  alert()\n},[date])\n  const login = async (e: React.FormEvent) => {\n    setLoading(true)\n    e.preventDefault();\n\n    //ADD DATA TO DB\n\n    const db = firebase.firestore()\n    const data = {\n      date:'12-10-19',\n      image:image,\n      time:time\n    }\n    try {\n      var docRef = db.collection('waste_collection_details').doc(phone)\n\n      docRef.get().then(async(doc) => {\n          if(doc.exists) {\n            let doc_data = doc.data()\n            let bookings = doc_data.bookings.push(data)\n            let res = await db.collection('waste_collection_details').doc(phone).update({bookings})\n\n          }else{\n            let res = await db.collection('waste_collection_details').doc(phone).set({bookings:[data]})\n\n          }\n        })\n\n      // alert()\n      setShowModal(true)\n    }catch(e) {\n      console.log(e)\n    }\n    \n    \n    \n  };\n  const getPicture = async() => {\n      const res = addImage(CameraSource.Photos)\n  }\n  const addImage  = async(source: CameraSource) => {\n    try{\n      const images = await Camera.getPhoto({\n        quality: 60,\n        allowEditing: true,\n        resultType: CameraResultType.DataUrl,\n        source\n      });\n      if(images){\n        setImage(images)\n      }\n    }\n    catch(err){\n      console.log(err)\n    }\n \n    \n\n  }\n  \n \n  \n  return (\n    <IonPage id=\"details-page\">\n      <IonHeader>\n        <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonMenuButton></IonMenuButton>\n          </IonButtons>\n          <IonTitle>Book Your Slot</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n\n        <form noValidate onSubmit={login}>\n          <IonList>\n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Select Date</IonLabel>\n              <IonDatetime min={'2021-06-15'} max={'2025-01-01'} value={date} onIonChange={e => setDate(e.detail.value!)}/>\n              \n            </IonItem>\n\n            {formSubmitted && usernameError && <IonText color=\"danger\">\n              <p className=\"ion-padding-start\">\n                Date is required\n              </p>\n            </IonText>}\n\n            \n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Time</IonLabel>\n              <IonSelect value={time} placeholder=\"Select One\" onIonChange={e => setTime(e.detail.value)}>\n                \n                {timeslots.map(i => \n                <IonSelectOption value={i}>{i}</IonSelectOption>\n                    )}\n              </IonSelect>\n            </IonItem>\n           \n            \n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Picture</IonLabel>\n              <IonButton style={{borderRadius:0}} color=\"primary\" onClick={()=>{getPicture()}}>\n                {/* <IonIcon name=\"camera\"/> */}\n                Upload Picture</IonButton>\n            </IonItem>\n            {image!==null && \n            <div style={{margin:'20px'}}>\n              <img style={{marginTop:'10px'}} src={image.dataUrl}/></div>}\n              \n          </IonList>\n\n          <IonRow>\n            <IonCol>\n              <IonButton disabled={loading} type=\"submit\" expand=\"block\" onClick={(e)=>login(e)}>Submit</IonButton>\n            </IonCol>\n            {/* <IonCol>\n              <IonButton routerLink=\"/signup\" color=\"light\" expand=\"block\">Signup</IonButton>\n            </IonCol> */}\n          </IonRow>\n          <Modal openModal={showModal} text={`You have selected ${time} on ${date}`} closeModal={()=>history.push('/dashboard', {direction: 'none'})}/>\n\n        </form>\n\n      </IonContent>\n\n    </IonPage>\n  );\n};\n\nexport default connect<OwnProps, {}, DispatchProps>({\n  mapDispatchToProps: {\n    setIsLoggedIn,\n    setUsername,\n    getUserData\n  },\n  component: BookSlot\n})"]},"metadata":{},"sourceType":"module"}