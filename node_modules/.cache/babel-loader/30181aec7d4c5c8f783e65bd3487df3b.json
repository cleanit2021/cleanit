{"ast":null,"code":"import _regeneratorRuntime from \"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/fazna/cleanit/src/pages/DetailsPage.tsx\";\n\nimport React, { useEffect, useState } from 'react';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonPage, IonButtons, IonMenuButton, IonRow, IonCol, IonButton, IonList, IonItem, IonLabel, IonInput, IonText, IonTextarea, IonToggle } from '@ionic/react';\nimport './Login.scss';\nimport { setIsLoggedIn, setUsername } from '../data/user/user.actions';\nimport { connect } from '../data/connect';\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport { getUserData } from '../data/dataApi';\nimport { Plugins } from '@capacitor/core';\nimport { Modal } from './Modal';\nvar Geolocation = Plugins.Geolocation;\n\nvar Login = function Login(_ref) {\n  var setIsLoggedIn = _ref.setIsLoggedIn,\n      history = _ref.history,\n      setUsername = _ref.setUsername;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      username = _useState2[0],\n      setUserName = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      pincode = _useState4[0],\n      setPincode = _useState4[1];\n\n  var _useState5 = useState({\n    latitude: 0,\n    longitude: 0\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      coord = _useState6[0],\n      setCoord = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      location = _useState8[0],\n      setLocation = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      gpsEnable = _useState10[0],\n      setGpsEnabled = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      formSubmitted = _useState12[0],\n      setFormSubmitted = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      usernameError = _useState14[0],\n      setUsernameError = _useState14[1];\n\n  var _useState15 = useState(''),\n      _useState16 = _slicedToArray(_useState15, 2),\n      phone = _useState16[0],\n      setPhone = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      loading = _useState18[0],\n      setLoading = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      showModal = _useState20[0],\n      setShowModal = _useState20[1];\n\n  var _useState21 = useState(false),\n      _useState22 = _slicedToArray(_useState21, 2),\n      showlocModal = _useState22[0],\n      setShowLocModal = _useState22[1];\n\n  var _useState23 = useState('1'),\n      _useState24 = _slicedToArray(_useState23, 2),\n      reset = _useState24[0],\n      setReset = _useState24[1];\n\n  var db = firebase.firestore();\n  useEffect(function () {\n    console.log(\"Hello getuserdata\", phone);\n\n    function getData() {\n      return _getData.apply(this, arguments);\n    }\n\n    function _getData() {\n      _getData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var res, docRef;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getUserData();\n\n              case 2:\n                res = _context.sent;\n                setStateofPhoneNumber(res.username);\n                console.log(res);\n\n                if (res.username !== '') {\n                  docRef = db.collection(\"user_data\").doc(res.username);\n                  docRef.get().then(function (doc) {\n                    if (doc.exists) {\n                      console.log('DOC EXISTS', doc.data().pincode, parseInt(doc.data().pincode));\n                      setUserName(doc.data().name);\n                      setStateofPincode(doc.data().pincode);\n                      setCoord(doc.data().coord);\n                      setPincode(doc.data().pin);\n                      setLocation(doc.data().location);\n                    }\n                  });\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _getData.apply(this, arguments);\n    }\n\n    getData();\n    console.log(\"Hello getuserdata\", phone);\n  }, [getUserData]);\n\n  var setStateofPhoneNumber = function setStateofPhoneNumber(phonenum) {\n    setPhone(phonenum);\n  };\n\n  var setStateofPincode = function setStateofPincode(data) {\n    setPincode(data);\n  };\n\n  var login = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var data, docRef;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n              setFormSubmitted(true);\n\n              if (!username) {\n                setUsernameError(true);\n              }\n\n              data = {\n                name: username,\n                coord: coord,\n                location: location,\n                pincode: pincode\n              };\n              docRef = db.collection(\"user_data\").doc(phone);\n              docRef.get().then( /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(doc) {\n                  var res;\n                  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          if (!doc.exists) {\n                            _context2.next = 4;\n                            break;\n                          }\n\n                          console.log(\"Doc exists\", phone);\n                          _context2.next = 8;\n                          break;\n\n                        case 4:\n                          _context2.next = 6;\n                          return db.collection('user_data').doc(phone).set(data);\n\n                        case 6:\n                          res = _context2.sent;\n                          setShowModal(true);\n\n                        case 8:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2);\n                }));\n\n                return function (_x2) {\n                  return _ref3.apply(this, arguments);\n                };\n              }()).catch(function (error) {\n                console.log(\"Error getting document:\", error);\n              });\n              history.push('/dashboard', {\n                direction: 'none'\n              });\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function login(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getLocation = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var c, bool;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              Geolocation.getCurrentPosition().then(function (coordinates) {\n                // lat= coordinates.coords.latitude || 0\n                // long = coordinates.coords.longitude || 0\n                c = {\n                  latitude: coordinates.coords.latitude,\n                  longitude: coordinates.coords.longitude\n                };\n                setCoord(c);\n                setShowLocModal(true);\n                console.log('Current position:', coordinates.coords.latitude, coord, showModal);\n                bool = true;\n              }).catch(function (e) {\n                console.log(e);\n              }); // console.log('Current position:',coordinates.coords.latitude,coord);\n              // api.get('http://api.positionstack.com/v1/forward?access_key=bce98239614aaa6f7954015a64f6bb76')\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function getLocation() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(IonPage, {\n    id: \"details-page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(IonHeader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IonToolbar, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonButtons, {\n    slot: \"start\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonMenuButton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(IonTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, \"Details\"))), /*#__PURE__*/React.createElement(IonContent, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    noValidate: true,\n    onSubmit: login,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonList, {\n    className: \"div-with-space\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 15\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(IonInput, {\n    name: \"username\",\n    type: \"text\",\n    value: username,\n    spellCheck: false,\n    autocapitalize: \"off\",\n    onIonChange: function onIonChange(e) {\n      return setUserName(e.detail.value);\n    },\n    required: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  })), formSubmitted && usernameError && /*#__PURE__*/React.createElement(IonText, {\n    color: \"danger\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 48\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"ion-padding-start\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 15\n    }\n  }, \"Name is required\")), pincode, /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 15\n    }\n  }, \"Pincode\"), /*#__PURE__*/React.createElement(IonInput, {\n    name: \"age\",\n    value: pincode,\n    placeholder: pincode,\n    onIonChange: function onIonChange(e) {\n      return setPincode(e.detail.value);\n    },\n    required: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 15\n    }\n  }, \"Use GPS\"), /*#__PURE__*/React.createElement(IonToggle, {\n    checked: gpsEnable,\n    onIonChange: function onIonChange(e) {\n      return setGpsEnabled(e.detail.checked);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 15\n    }\n  })), !gpsEnable && /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 15\n    }\n  }, \"Location\"), /*#__PURE__*/React.createElement(IonTextarea, {\n    name: \"text\",\n    value: location,\n    spellCheck: false,\n    autocapitalize: \"off\",\n    onIonChange: function onIonChange(e) {\n      return setLocation(e.detail.value);\n    },\n    required: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  })), gpsEnable && /*#__PURE__*/React.createElement(IonItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    position: \"stacked\",\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 15\n    }\n  }, \"Location\"), /*#__PURE__*/React.createElement(IonButton, {\n    color: \"primary\",\n    onClick: function onClick() {\n      getLocation();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 15\n    }\n  }, \"Use Current Location\")), /*#__PURE__*/React.createElement(IonButton, {\n    onClick: function onClick() {\n      console.log(pincode, parseInt(\"678547\"));\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 1\n    }\n  }, \"Phone\")), /*#__PURE__*/React.createElement(IonRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonButton, {\n    disabled: loading,\n    type: \"submit\",\n    expand: \"block\",\n    onClick: function onClick(e) {\n      return login(e);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }\n  }, \"Submit\")))), /*#__PURE__*/React.createElement(Modal, {\n    openModal: showlocModal,\n    text: 'Successfully selected Data',\n    closeModal: function closeModal() {\n      setShowLocModal(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Modal, {\n    openModal: showModal,\n    text: 'Hi' + username + \", We have successfully entered Your Details\",\n    closeModal: function closeModal() {\n      return history.push('/dashboard', {\n        direction: 'none'\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default connect({\n  mapDispatchToProps: {\n    setIsLoggedIn: setIsLoggedIn,\n    setUsername: setUsername,\n    getUserData: getUserData\n  },\n  component: Login\n});","map":{"version":3,"sources":["/home/fazna/cleanit/src/pages/DetailsPage.tsx"],"names":["React","useEffect","useState","IonHeader","IonToolbar","IonTitle","IonContent","IonPage","IonButtons","IonMenuButton","IonRow","IonCol","IonButton","IonList","IonItem","IonLabel","IonInput","IonText","IonTextarea","IonToggle","setIsLoggedIn","setUsername","connect","firebase","getUserData","Plugins","Modal","Geolocation","Login","history","username","setUserName","pincode","setPincode","latitude","longitude","coord","setCoord","location","setLocation","gpsEnable","setGpsEnabled","formSubmitted","setFormSubmitted","usernameError","setUsernameError","phone","setPhone","loading","setLoading","showModal","setShowModal","showlocModal","setShowLocModal","reset","setReset","db","firestore","console","log","getData","res","setStateofPhoneNumber","docRef","collection","doc","get","then","exists","data","parseInt","name","setStateofPincode","pin","phonenum","login","e","preventDefault","set","catch","error","push","direction","getLocation","getCurrentPosition","coordinates","c","coords","bool","detail","value","checked","mapDispatchToProps","component"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,SAAT,EAAoBC,UAApB,EAAgCC,QAAhC,EAA0CC,UAA1C,EAAsDC,OAAtD,EAA+DC,UAA/D,EAA2EC,aAA3E,EAA0FC,MAA1F,EAAkGC,MAAlG,EAA0GC,SAA1G,EAAqHC,OAArH,EAA8HC,OAA9H,EAAuIC,QAAvI,EAAiJC,QAAjJ,EAA2JC,OAA3J,EAAoKC,WAApK,EAAiLC,SAAjL,QAA4M,cAA5M;AACA,OAAO,cAAP;AACA,SAASC,aAAT,EAAwBC,WAAxB,QAA2C,2BAA3C;AACA,SAASC,OAAT,QAAwB,iBAAxB;AAEA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAO,oBAAP;AACA,SAASC,WAAT,QAA4B,iBAA5B;AACA,SAAUC,OAAV,QAAyB,iBAAzB;AAGA,SAASC,KAAT,QAAsB,SAAtB;AAEA,IAAQC,WAAR,GAAwBF,OAAxB,CAAQE,WAAR;;AAWA,IAAMC,KAA2B,GAAG,SAA9BA,KAA8B,OAA2C;AAAA,MAAzCR,aAAyC,QAAzCA,aAAyC;AAAA,MAA1BS,OAA0B,QAA1BA,OAA0B;AAAA,MAAjBR,WAAiB,QAAjBA,WAAiB;;AAE7E,kBAAgCnB,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAO4B,QAAP;AAAA,MAAiBC,WAAjB;;AACA,mBAA6B7B,QAAQ,CAAC,EAAD,CAArC;AAAA;AAAA,MAAO8B,OAAP;AAAA,MAAeC,UAAf;;AACA,mBAAyB/B,QAAQ,CAAC;AAChCgC,IAAAA,QAAQ,EAAC,CADuB;AAEhCC,IAAAA,SAAS,EAAC;AAFsB,GAAD,CAAjC;AAAA;AAAA,MAAOC,KAAP;AAAA,MAAaC,QAAb;;AAIA,mBAA+BnC,QAAQ,CAAC,EAAD,CAAvC;AAAA;AAAA,MAAOoC,QAAP;AAAA,MAAgBC,WAAhB;;AACA,mBAAkCrC,QAAQ,CAAC,KAAD,CAA1C;AAAA;AAAA,MAAOsC,SAAP;AAAA,MAAiBC,aAAjB;;AACA,oBAA0CvC,QAAQ,CAAC,KAAD,CAAlD;AAAA;AAAA,MAAOwC,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,oBAA0CzC,QAAQ,CAAC,KAAD,CAAlD;AAAA;AAAA,MAAO0C,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,oBAAyB3C,QAAQ,CAAC,EAAD,CAAjC;AAAA;AAAA,MAAO4C,KAAP;AAAA,MAAaC,QAAb;;AACA,oBAA6B7C,QAAQ,CAAC,KAAD,CAArC;AAAA;AAAA,MAAO8C,OAAP;AAAA,MAAeC,UAAf;;AACA,oBAAiC/C,QAAQ,CAAC,KAAD,CAAzC;AAAA;AAAA,MAAOgD,SAAP;AAAA,MAAiBC,YAAjB;;AACA,oBAAuCjD,QAAQ,CAAC,KAAD,CAA/C;AAAA;AAAA,MAAOkD,YAAP;AAAA,MAAoBC,eAApB;;AAEA,oBAAyBnD,QAAQ,CAAC,GAAD,CAAjC;AAAA;AAAA,MAAOoD,KAAP;AAAA,MAAaC,QAAb;;AACA,MAAMC,EAAE,GAAGjC,QAAQ,CAACkC,SAAT,EAAX;AACAxD,EAAAA,SAAS,CAAC,YAAI;AACZyD,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCb,KAAjC;;AADY,aAEGc,OAFH;AAAA;AAAA;;AAAA;AAAA,0EAEZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACkBpC,WAAW,EAD7B;;AAAA;AACMqC,gBAAAA,GADN;AAEEC,gBAAAA,qBAAqB,CAACD,GAAG,CAAC/B,QAAL,CAArB;AACA4B,gBAAAA,OAAO,CAACC,GAAR,CAAYE,GAAZ;;AACA,oBAAGA,GAAG,CAAC/B,QAAJ,KAAe,EAAlB,EAAqB;AACfiC,kBAAAA,MADe,GACNP,EAAE,CAACQ,UAAH,CAAc,WAAd,EAA2BC,GAA3B,CAA+BJ,GAAG,CAAC/B,QAAnC,CADM;AAGnBiC,kBAAAA,MAAM,CAACG,GAAP,GAAaC,IAAb,CAAkB,UAACF,GAAD,EAAS;AACvB,wBAAGA,GAAG,CAACG,MAAP,EAAe;AACbV,sBAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyBM,GAAG,CAACI,IAAJ,GAAWrC,OAApC,EAA4CsC,QAAQ,CAACL,GAAG,CAACI,IAAJ,GAAWrC,OAAZ,CAApD;AACAD,sBAAAA,WAAW,CAACkC,GAAG,CAACI,IAAJ,GAAWE,IAAZ,CAAX;AACAC,sBAAAA,iBAAiB,CAACP,GAAG,CAACI,IAAJ,GAAWrC,OAAZ,CAAjB;AACAK,sBAAAA,QAAQ,CAAC4B,GAAG,CAACI,IAAJ,GAAWjC,KAAZ,CAAR;AACAH,sBAAAA,UAAU,CAACgC,GAAG,CAACI,IAAJ,GAAWI,GAAZ,CAAV;AACAlC,sBAAAA,WAAW,CAAC0B,GAAG,CAACI,IAAJ,GAAW/B,QAAZ,CAAX;AACD;AAAC,mBARN;AASD;;AAhBH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAFY;AAAA;AAAA;;AAoBZsB,IAAAA,OAAO;AACPF,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCb,KAAjC;AACD,GAtBQ,EAsBP,CAACtB,WAAD,CAtBO,CAAT;;AAwBA,MAAMsC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACY,QAAD,EAAkB;AAC9C3B,IAAAA,QAAQ,CAAC2B,QAAD,CAAR;AACD,GAFD;;AAGA,MAAMF,iBAAiB,GAAG,SAApBA,iBAAoB,CAACH,IAAD,EAAc;AACtCpC,IAAAA,UAAU,CAACoC,IAAD,CAAV;AAED,GAHD;;AAIA,MAAMM,KAAK;AAAA,yEAAG,kBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACZA,cAAAA,CAAC,CAACC,cAAF;AACA5B,cAAAA,UAAU,CAAC,IAAD,CAAV;AACAN,cAAAA,gBAAgB,CAAC,IAAD,CAAhB;;AACA,kBAAG,CAACb,QAAJ,EAAc;AACZe,gBAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD;;AAEKwB,cAAAA,IARM,GAQC;AACXE,gBAAAA,IAAI,EAAGzC,QADI;AAEXM,gBAAAA,KAAK,EAALA,KAFW;AAGXE,gBAAAA,QAAQ,EAARA,QAHW;AAIXN,gBAAAA,OAAO,EAAPA;AAJW,eARD;AAeR+B,cAAAA,MAfQ,GAeCP,EAAE,CAACQ,UAAH,CAAc,WAAd,EAA2BC,GAA3B,CAA+BnB,KAA/B,CAfD;AAgBZiB,cAAAA,MAAM,CAACG,GAAP,GAAaC,IAAb;AAAA,qFAAkB,kBAAMF,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BACXA,GAAG,CAACG,MADO;AAAA;AAAA;AAAA;;AAEZV,0BAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyBb,KAAzB;AAFY;AAAA;;AAAA;AAAA;AAAA,iCAKMU,EAAE,CAACQ,UAAH,CAAc,WAAd,EAA2BC,GAA3B,CAA+BnB,KAA/B,EAAsCgC,GAAtC,CAA0CT,IAA1C,CALN;;AAAA;AAKNR,0BAAAA,GALM;AAMVV,0BAAAA,YAAY,CAAC,IAAD,CAAZ;;AANU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAlB;;AAAA;AAAA;AAAA;AAAA,mBAQG4B,KARH,CAQS,UAACC,KAAD,EAAW;AAChBtB,gBAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ,EAAuCqB,KAAvC;AACH,eAVD;AAWAnD,cAAAA,OAAO,CAACoD,IAAR,CAAa,YAAb,EAA2B;AAACC,gBAAAA,SAAS,EAAE;AAAZ,eAA3B;;AA3BY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAALP,KAAK;AAAA;AAAA;AAAA,KAAX;;AA8BA,MAAMQ,WAAW;AAAA,yEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAGlBxD,cAAAA,WAAW,CAACyD,kBAAZ,GAAiCjB,IAAjC,CACE,UAACkB,WAAD,EAAiB;AACf;AACA;AACDC,gBAAAA,CAAC,GAAG;AACDpD,kBAAAA,QAAQ,EAAEmD,WAAW,CAACE,MAAZ,CAAmBrD,QAD5B;AACqCC,kBAAAA,SAAS,EAACkD,WAAW,CAACE,MAAZ,CAAmBpD;AADlE,iBAAJ;AAGCE,gBAAAA,QAAQ,CAACiD,CAAD,CAAR;AACJjC,gBAAAA,eAAe,CAAC,IAAD,CAAf;AACEK,gBAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAgC0B,WAAW,CAACE,MAAZ,CAAmBrD,QAAnD,EAA4DE,KAA5D,EAAkEc,SAAlE;AACAsC,gBAAAA,IAAI,GAAG,IAAP;AACC,eAXH,EAaET,KAbF,CAaQ,UAAAH,CAAC,EAAI;AACXlB,gBAAAA,OAAO,CAACC,GAAR,CAAYiB,CAAZ;AACD,eAfD,EAHkB,CAoBpB;AACE;;AArBkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAXO,WAAW;AAAA;AAAA;AAAA,KAAjB;;AAuBA,sBACE,oBAAC,OAAD;AAAS,IAAA,EAAE,EAAC,cAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,UAAD;AAAY,IAAA,IAAI,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eAIE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAJF,CADF,CADF,eASE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEE;AAAM,IAAA,UAAU,MAAhB;AAAiB,IAAA,QAAQ,EAAER,KAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,OAAD;AAAS,IAAA,SAAS,EAAC,gBAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAU,IAAA,QAAQ,EAAC,SAAnB;AAA6B,IAAA,KAAK,EAAC,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAEE,oBAAC,QAAD;AAAU,IAAA,IAAI,EAAC,UAAf;AAA0B,IAAA,IAAI,EAAC,MAA/B;AAAsC,IAAA,KAAK,EAAE7C,QAA7C;AAAuD,IAAA,UAAU,EAAE,KAAnE;AAA0E,IAAA,cAAc,EAAC,KAAzF;AAA+F,IAAA,WAAW,EAAE,qBAAA8C,CAAC;AAAA,aAAI7C,WAAW,CAAC6C,CAAC,CAACa,MAAF,CAASC,KAAV,CAAf;AAAA,KAA7G;AACE,IAAA,QAAQ,MADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,EAQGhD,aAAa,IAAIE,aAAjB,iBAAkC,oBAAC,OAAD;AAAS,IAAA,KAAK,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACjC;AAAG,IAAA,SAAS,EAAC,mBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADiC,CARrC,EAcGZ,OAdH,eAeE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAU,IAAA,QAAQ,EAAC,SAAnB;AAA6B,IAAA,KAAK,EAAC,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE,oBAAC,QAAD;AAAU,IAAA,IAAI,EAAC,KAAf;AAAqB,IAAA,KAAK,EAAEA,OAA5B;AAAqC,IAAA,WAAW,EAAEA,OAAlD;AAA2D,IAAA,WAAW,EAAE,qBAAA4C,CAAC;AAAA,aAAI3C,UAAU,CAAC2C,CAAC,CAACa,MAAF,CAASC,KAAV,CAAd;AAAA,KAAzE;AACE,IAAA,QAAQ,MADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAfF,eAsBE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAU,IAAA,QAAQ,EAAC,SAAnB;AAA6B,IAAA,KAAK,EAAC,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE,oBAAC,SAAD;AAAW,IAAA,OAAO,EAAElD,SAApB;AAA+B,IAAA,WAAW,EAAE,qBAAAoC,CAAC;AAAA,aAAInC,aAAa,CAACmC,CAAC,CAACa,MAAF,CAASE,OAAV,CAAjB;AAAA,KAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CAtBF,EA2BI,CAACnD,SAAD,iBACF,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAU,IAAA,QAAQ,EAAC,SAAnB;AAA6B,IAAA,KAAK,EAAC,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE,oBAAC,WAAD;AAAa,IAAA,IAAI,EAAC,MAAlB;AAAyB,IAAA,KAAK,EAAEF,QAAhC;AAA0C,IAAA,UAAU,EAAE,KAAtD;AAA6D,IAAA,cAAc,EAAC,KAA5E;AAAkF,IAAA,WAAW,EAAE,qBAAAsC,CAAC;AAAA,aAAIrC,WAAW,CAACqC,CAAC,CAACa,MAAF,CAASC,KAAV,CAAf;AAAA,KAAhG;AACE,IAAA,QAAQ,MADV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CA5BF,EAkCIlD,SAAS,iBACX,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAU,IAAA,QAAQ,EAAC,SAAnB;AAA6B,IAAA,KAAK,EAAC,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,SAAjB;AAA2B,IAAA,OAAO,EAAE,mBAAI;AAAC2C,MAAAA,WAAW;AAAG,KAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAFF,CAnCF,eAwCV,oBAAC,SAAD;AAAW,IAAA,OAAO,EAAE,mBAClB;AACEzB,MAAAA,OAAO,CAACC,GAAR,CAAY3B,OAAZ,EAAoBsC,QAAQ,CAAC,QAAD,CAA5B;AAAwC,KAF5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAxCU,CADF,eA+CE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAW,IAAA,QAAQ,EAAEtB,OAArB;AAA8B,IAAA,IAAI,EAAC,QAAnC;AAA4C,IAAA,MAAM,EAAC,OAAnD;AAA2D,IAAA,OAAO,EAAE,iBAAC4B,CAAD;AAAA,aAAKD,KAAK,CAACC,CAAD,CAAV;AAAA,KAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,CADF,CA/CF,CAFF,eA0DE,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAExB,YAAlB;AAAgC,IAAA,IAAI,EAAE,4BAAtC;AAAoE,IAAA,UAAU,EAAE,sBAAI;AAACC,MAAAA,eAAe,CAAC,KAAD,CAAf;AAAuB,KAA5G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA1DF,eA6DE,oBAAC,KAAD;AAAO,IAAA,SAAS,EAAEH,SAAlB;AAA6B,IAAA,IAAI,EAAE,OAAKpB,QAAL,gDAAnC;AAAgG,IAAA,UAAU,EAAE;AAAA,aAAID,OAAO,CAACoD,IAAR,CAAa,YAAb,EAA2B;AAACC,QAAAA,SAAS,EAAE;AAAZ,OAA3B,CAAJ;AAAA,KAA5G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7DF,CATF,CADF;AA6ED,CApLD;;AAsLA,eAAe5D,OAAO,CAA8B;AAClDsE,EAAAA,kBAAkB,EAAE;AAClBxE,IAAAA,aAAa,EAAbA,aADkB;AAElBC,IAAAA,WAAW,EAAXA,WAFkB;AAGlBG,IAAAA,WAAW,EAAXA;AAHkB,GAD8B;AAMlDqE,EAAAA,SAAS,EAAEjE;AANuC,CAA9B,CAAtB","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonPage, IonButtons, IonMenuButton, IonRow, IonCol, IonButton, IonList, IonItem, IonLabel, IonInput, IonText, IonTextarea, IonToggle, IonModal } from '@ionic/react';\nimport './Login.scss';\nimport { setIsLoggedIn, setUsername } from '../data/user/user.actions';\nimport { connect } from '../data/connect';\nimport { RouteComponentProps } from 'react-router';\nimport firebase from 'firebase/app'\nimport 'firebase/firestore';\nimport { getUserData } from '../data/dataApi';\nimport {  Plugins } from '@capacitor/core'\nimport MapView from './MapView';\nimport Map from '../components/Map';\nimport { Modal } from './Modal';\n\nconst { Geolocation } = Plugins\ninterface OwnProps extends RouteComponentProps {}\n\ninterface DispatchProps {\n  setIsLoggedIn: typeof setIsLoggedIn;\n  setUsername: typeof setUsername;\n  getUserData: typeof getUserData;\n}\n\ninterface LoginProps extends OwnProps,  DispatchProps { }\n\nconst Login: React.FC<LoginProps> = ({setIsLoggedIn, history, setUsername}) => {\n\n  const [username, setUserName] = useState('');\n  const [pincode,setPincode] = useState('');\n  const [coord,setCoord] = useState({\n    latitude:0,\n    longitude:0\n  });\n  const [location,setLocation] = useState('');\n  const [gpsEnable,setGpsEnabled] = useState(false);\n  const [formSubmitted, setFormSubmitted] = useState(false);\n  const [usernameError, setUsernameError] = useState(false);\n  const [phone,setPhone] = useState('');\n  const [loading,setLoading] = useState(false);\n  const [showModal,setShowModal] = useState(false);\n  const [showlocModal,setShowLocModal] = useState(false);\n\n  const [reset,setReset] = useState('1')\n  const db = firebase.firestore()\n  useEffect(()=>{\n    console.log(\"Hello getuserdata\", phone)\n    async function getData() {\n      let res = await getUserData()\n      setStateofPhoneNumber(res.username)\n      console.log(res)\n      if(res.username!==''){\n        var docRef = db.collection(\"user_data\").doc(res.username);\n\n        docRef.get().then((doc) => {\n            if(doc.exists) {\n              console.log('DOC EXISTS',doc.data().pincode,parseInt(doc.data().pincode))  \n              setUserName(doc.data().name)   \n              setStateofPincode(doc.data().pincode)\n              setCoord(doc.data().coord)\n              setPincode(doc.data().pin) \n              setLocation(doc.data().location)      \n            }})\n      }  \n    }\n    getData()\n    console.log(\"Hello getuserdata\", phone)\n  },[getUserData])\n\n  const setStateofPhoneNumber = (phonenum:any) => {\n    setPhone(phonenum)\n  }\n  const setStateofPincode = (data:any) => {\n    setPincode(data)\n    \n  }\n  const login = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true)\n    setFormSubmitted(true);\n    if(!username) {\n      setUsernameError(true);\n    }\n    \n    const data = {\n      name : username,\n      coord,\n      location,\n      pincode\n    }\n\n    var docRef = db.collection(\"user_data\").doc(phone);\n    docRef.get().then(async(doc) => {\n        if(doc.exists) {\n          console.log(\"Doc exists\",phone);\n        } else {\n            // doc.data() will be undefined in this case\n            let res = await db.collection('user_data').doc(phone).set(data)\n            setShowModal(true)\n        }\n    }).catch((error) => {\n        console.log(\"Error getting document:\", error);\n    });\n    history.push('/dashboard', {direction: 'none'});\n\n  };\n  const getLocation = async() => {\n    var c;\n    var bool;\n    Geolocation.getCurrentPosition().then(\n      (coordinates) => {\n        // lat= coordinates.coords.latitude || 0\n        // long = coordinates.coords.longitude || 0\n       c = {\n          latitude: coordinates.coords.latitude,longitude:coordinates.coords.longitude\n        }\n        setCoord(c)\n    setShowLocModal(true)\n      console.log('Current position:',coordinates.coords.latitude,coord,showModal);\n      bool = true\n      }\n      \n    ).catch(e => {\n      console.log(e)\n    });\n   \n  // console.log('Current position:',coordinates.coords.latitude,coord);\n    // api.get('http://api.positionstack.com/v1/forward?access_key=bce98239614aaa6f7954015a64f6bb76')\n  }\n  return (\n    <IonPage id=\"details-page\">\n      <IonHeader>\n        <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonMenuButton></IonMenuButton>\n          </IonButtons>\n          <IonTitle>Details</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n\n        <form noValidate onSubmit={login}>\n          <IonList className=\"div-with-space\">\n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Name</IonLabel>\n              <IonInput name=\"username\" type=\"text\" value={username} spellCheck={false} autocapitalize=\"off\" onIonChange={e => setUserName(e.detail.value!)}\n                required>\n              </IonInput>\n            </IonItem>\n\n            {formSubmitted && usernameError && <IonText color=\"danger\">\n              <p className=\"ion-padding-start\">\n                Name is required\n              </p>\n            </IonText>}\n\n            {pincode}\n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Pincode</IonLabel>\n              <IonInput name=\"age\" value={pincode} placeholder={pincode} onIonChange={e => setPincode(e.detail.value!)}\n                required>\n              </IonInput>\n            </IonItem>\n\n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Use GPS</IonLabel>\n              <IonToggle checked={gpsEnable} onIonChange={e => setGpsEnabled(e.detail.checked)} />\n            \n            </IonItem>\n            { !gpsEnable && \n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Location</IonLabel>\n              <IonTextarea name=\"text\" value={location} spellCheck={false} autocapitalize=\"off\" onIonChange={e => setLocation(e.detail.value!)}\n                required>\n              </IonTextarea>\n            </IonItem>}\n            { gpsEnable && \n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Location</IonLabel>\n              <IonButton color=\"primary\" onClick={()=>{getLocation()}}>Use Current Location</IonButton>\n              \n            </IonItem>}\n<IonButton onClick={()=>\n  {\n    console.log(pincode,parseInt(\"678547\"))}\n  }>Phone</IonButton>\n          </IonList>\n              \n          <IonRow>\n            <IonCol>\n              <IonButton disabled={loading} type=\"submit\" expand=\"block\" onClick={(e)=>login(e)}>Submit</IonButton>\n            </IonCol>\n            {/* <IonCol>\n              <IonButton routerLink=\"/signup\" color=\"light\" expand=\"block\">Signup</IonButton>\n            </IonCol> */}\n          </IonRow>\n        </form>\n        <Modal openModal={showlocModal} text={'Successfully selected Data'} closeModal={()=>{setShowLocModal(false)}}/>\n           \n\n        <Modal openModal={showModal} text={'Hi'+username+`, We have successfully entered Your Details`} closeModal={()=>history.push('/dashboard', {direction: 'none'})}/>\n        \n      </IonContent>\n     \n    </IonPage>\n  );\n};\n\nexport default connect<OwnProps, {}, DispatchProps>({\n  mapDispatchToProps: {\n    setIsLoggedIn,\n    setUsername,\n    getUserData\n  },\n  component: Login\n})"]},"metadata":{},"sourceType":"module"}