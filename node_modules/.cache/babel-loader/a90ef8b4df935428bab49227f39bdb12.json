{"ast":null,"code":"import _regeneratorRuntime from\"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fazna/cleanit/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{IonHeader,IonToolbar,IonTitle,IonContent,IonPage,IonButtons,IonMenuButton,IonRow,IonCol,IonButton,IonList,IonItem,IonLabel,IonInput,IonText,IonModal,IonAlert,IonCard,IonCardContent}from'@ionic/react';import'./Login.scss';import{setIsLoggedIn,setUsername}from'../data/user/user.actions';import{connect}from'../data/connect';import firebase from\"firebase/app\";import\"firebase/auth\";import{Plugins}from'@capacitor/core';import{getUserData}from'../data/dataApi';// import { Storage } from '@capacitor/storage';\nvar Storage=Plugins.Storage;var Login=function Login(_ref){var setIsLoggedIn=_ref.setIsLoggedIn,history=_ref.history,setUsername=_ref.setUsername;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUserName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),formSubmitted=_useState6[0],setFormSubmitted=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),usernameError=_useState8[0],setUsernameError=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),passwordError=_useState10[0],setPasswordError=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showModal=_useState12[0],setShowModal=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),showAlert1=_useState14[0],setShowAlert1=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),loading=_useState16[0],setLoading=_useState16[1];useEffect(function(){function checkIfSignedIn(){return _checkIfSignedIn.apply(this,arguments);}function _checkIfSignedIn(){_checkIfSignedIn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var checkname;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return checkName();case 2:checkname=_context.sent;if(checkname!==null){history.push('/dashboard',{direction:'none'});}case 4:case\"end\":return _context.stop();}}},_callee);}));return _checkIfSignedIn.apply(this,arguments);}checkIfSignedIn();},[history]);var setName=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(val){var checkname;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return checkName();case 2:checkname=_context2.sent;if(!(checkname===null)){_context2.next=6;break;}_context2.next=6;return Storage.set({key:'phonenumber',value:val});case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function setName(_x){return _ref2.apply(this,arguments);};}();var checkName=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _yield$Storage$get,value;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return Storage.get({key:'phonenumber'});case 2:_yield$Storage$get=_context3.sent;value=_yield$Storage$get.value;console.log(value);return _context3.abrupt(\"return\",value);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function checkName(){return _ref3.apply(this,arguments);};}();var removeName=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return Storage.remove({key:'phonenumber'});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function removeName(){return _ref4.apply(this,arguments);};}();var checkData=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(\"username\",username,\"type\",typeof username);setUsername(username);_context5.next=4;return getUserData();case 4:res=_context5.sent;console.log(res);case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function checkData(){return _ref5.apply(this,arguments);};}();// React.useEffect(()=>{\n// })\nvar login=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:setLoading(true);window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier('recaptcha-container');e.preventDefault();// setFormSubmitted(true);\nif(!username){setUsernameError(true);}if(!password){setPasswordError(true);}console.log(username);if(username){// window.recaptchaVerifier = \nfirebase.auth().signInWithPhoneNumber('+91'+username,window.recaptchaVerifier).then(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(confirmationResult){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:console.log(confirmationResult,typeof confirmationResult);window.confirmationResult=confirmationResult;setShowModal(true);setLoading(false);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x3){return _ref7.apply(this,arguments);};}()).catch(function(error){// Error; SMS not sent\n// ...\nconsole.log(error);setPasswordError(true);});}case 7:case\"end\":return _context7.stop();}}},_callee7);}));return function login(_x2){return _ref6.apply(this,arguments);};}();var otpSubmit=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(otp){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:setShowModal(false);// if(confirmationRes!=={})\nsetLoading(true);window.confirmationResult.confirm(otp).then(/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(result){var user;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:// User signed in successfully.\nuser=result.user;_context8.next=3;return setIsLoggedIn(true);case 3:// await setUsernameAction(user);\nsetShowAlert1(true);setName(username);setUsername(username);history.push('/login',{direction:'none'});// ...\ncase 7:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x5){return _ref9.apply(this,arguments);};}()).catch(function(error){// User couldn't sign in (bad verification code?)\n// ...\n});case 3:case\"end\":return _context9.stop();}}},_callee9);}));return function otpSubmit(_x4){return _ref8.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(IonPage,{id:\"signup-page\"},/*#__PURE__*/React.createElement(IonHeader,null,/*#__PURE__*/React.createElement(IonToolbar,null,/*#__PURE__*/React.createElement(IonButtons,{slot:\"start\"},/*#__PURE__*/React.createElement(IonMenuButton,null)),/*#__PURE__*/React.createElement(IonTitle,null,\"Signup\"))),/*#__PURE__*/React.createElement(IonContent,null,/*#__PURE__*/React.createElement(\"div\",{className:\"login-logo\"},/*#__PURE__*/React.createElement(\"img\",{src:\"data:image/png;base64,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\",alt:\"Ionic logo\"})),/*#__PURE__*/React.createElement(\"form\",{noValidate:true,onSubmit:login},/*#__PURE__*/React.createElement(IonList,{className:\"div-with-space\"},/*#__PURE__*/React.createElement(IonItem,null,/*#__PURE__*/React.createElement(IonLabel,{position:\"stacked\",color:\"primary\"},\"Phone Number\"),/*#__PURE__*/React.createElement(IonInput,{name:\"username\",type:\"number\",value:username,spellCheck:false,autocapitalize:\"off\",onIonChange:function onIonChange(e){setUserName(e.detail.value);setUsernameError(false);},required:true})),formSubmitted&&usernameError&&/*#__PURE__*/React.createElement(IonText,{color:\"danger\"},/*#__PURE__*/React.createElement(\"p\",{className:\"ion-padding-start\"},\"Username is required\")),formSubmitted&&passwordError&&/*#__PURE__*/React.createElement(IonText,{color:\"danger\"},/*#__PURE__*/React.createElement(\"p\",{className:\"ion-padding-start\"},\"Error in code\"))),/*#__PURE__*/React.createElement(\"div\",{style:{margin:'10px'},id:\"recaptcha-container\"}),/*#__PURE__*/React.createElement(IonRow,null,/*#__PURE__*/React.createElement(IonCol,null,/*#__PURE__*/React.createElement(IonButton,{disabled:loading,type:\"submit\",expand:\"block\",id:\"sign-in-button\"},\"Send OTP\")))),/*#__PURE__*/React.createElement(IonModal,{isOpen:showModal,cssClass:\"my-custom-class\"},/*#__PURE__*/React.createElement(IonContent,null,/*#__PURE__*/React.createElement(IonToolbar,null,/*#__PURE__*/React.createElement(IonButtons,{slot:\"start\"},/*#__PURE__*/React.createElement(IonMenuButton,null)),/*#__PURE__*/React.createElement(IonTitle,null,\"OTP\")),/*#__PURE__*/React.createElement(IonCard,null,/*#__PURE__*/React.createElement(IonCardContent,null,/*#__PURE__*/React.createElement(IonItem,null,/*#__PURE__*/React.createElement(IonText,null,\"+91 \",username)),/*#__PURE__*/React.createElement(IonItem,null,/*#__PURE__*/React.createElement(IonLabel,{position:\"stacked\",color:\"primary\"},\"Enter your OTP\"),/*#__PURE__*/React.createElement(IonInput,{disabled:loading,name:\"otp\",type:\"number\",value:password,maxlength:1,onIonChange:function onIonChange(e){setPassword(e.detail.value);setPasswordError(false);}})),/*#__PURE__*/React.createElement(IonButton,{expand:\"block\",onClick:function onClick(){return otpSubmit(password);}},\"Submit\")))),/*#__PURE__*/React.createElement(IonAlert,{isOpen:showAlert1,onDidDismiss:function onDidDismiss(){setShowAlert1(false);},cssClass:\"my-custom-class\",header:'Registration Successfull',message:'Enter your details to continue',buttons:['OK']}))));};export default connect({mapDispatchToProps:{setIsLoggedIn:setIsLoggedIn,setUsername:setUsername,getUserData:getUserData},component:Login});","map":{"version":3,"sources":["/home/fazna/cleanit/src/pages/Signup.tsx"],"names":["React","useEffect","useState","IonHeader","IonToolbar","IonTitle","IonContent","IonPage","IonButtons","IonMenuButton","IonRow","IonCol","IonButton","IonList","IonItem","IonLabel","IonInput","IonText","IonModal","IonAlert","IonCard","IonCardContent","setIsLoggedIn","setUsername","connect","firebase","Plugins","getUserData","Storage","Login","history","username","setUserName","password","setPassword","formSubmitted","setFormSubmitted","usernameError","setUsernameError","passwordError","setPasswordError","showModal","setShowModal","showAlert1","setShowAlert1","loading","setLoading","checkIfSignedIn","checkName","checkname","push","direction","setName","val","set","key","value","get","console","log","removeName","remove","checkData","res","login","e","window","recaptchaVerifier","auth","RecaptchaVerifier","preventDefault","signInWithPhoneNumber","then","confirmationResult","catch","error","otpSubmit","otp","confirm","result","user","detail","margin","mapDispatchToProps","component"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonPage, IonButtons, IonMenuButton, IonRow, IonCol, IonButton, IonList, IonItem, IonLabel, IonInput, IonText, IonModal, IonAlert, IonCard, IonCardContent, IonRouterLink, IonSpinner } from '@ionic/react';\nimport './Login.scss';\nimport { setIsLoggedIn, setUsername } from '../data/user/user.actions';\nimport { connect } from '../data/connect';\nimport { RouteComponentProps } from 'react-router';\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport { Plugins } from '@capacitor/core'\nimport { getUserData } from '../data/dataApi';\n// import { Storage } from '@capacitor/storage';\nconst { Storage } = Plugins\ninterface OwnProps extends RouteComponentProps {}\n\ninterface DispatchProps {\n  setIsLoggedIn: typeof setIsLoggedIn;\n  setUsername: typeof setUsername;\n  getUserData: typeof getUserData;\n}\n\ninterface LoginProps extends OwnProps,  DispatchProps { }\n\nconst Login: React.FC<LoginProps> = ({setIsLoggedIn, history, setUsername}) => {\n\n  const [username, setUserName] = useState('');\n  const [password, setPassword] = useState('');\n  const [formSubmitted, setFormSubmitted] = useState(false);\n  const [usernameError, setUsernameError] = useState(false);\n  const [passwordError, setPasswordError] = useState(false);\n  const [showModal, setShowModal] = useState(false);\n  const [showAlert1, setShowAlert1] = useState(false);\n  const [loading,setLoading] = useState(false)\n  \n   useEffect(()=>{\n     async function checkIfSignedIn(){\n\n      let checkname =await checkName()\n      if(checkname!==null){\n        history.push('/dashboard', {direction: 'none'});\n      }\n     }\n     checkIfSignedIn()\n   },[history])\n\n  const setName = async(val:any) => {\n    let checkname= await checkName()\n    if(checkname===null){\n      await Storage.set({\n        key: 'phonenumber',\n        value: val,\n      });\n    }\n  };\n  \n  const checkName = async () => {\n    const { value } = await Storage.get({ key: 'phonenumber' });\n    console.log(value)\n    return value;\n    \n  };\n  \n  const removeName = async () => {\n    await Storage.remove({ key: 'phonenumber' });\n  };\n  const checkData = async () => {\n    console.log(\"username\",username,\"type\",typeof(username))\n    setUsername(username)\n    let res = await getUserData()\n    console.log(res)\n  }\n// React.useEffect(()=>{\n\n// })\n  const login = async (e: React.FormEvent) => {\n    setLoading(true)\n    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container');\n\n    e.preventDefault();\n    // setFormSubmitted(true);\n    if(!username) {\n      setUsernameError(true);\n    }\n    if(!password) {\n      setPasswordError(true);\n    }\n    console.log(username)\n\n    if(username) {\n      // window.recaptchaVerifier = \n      \n      firebase.auth().signInWithPhoneNumber(\n        '+91'+username,\n        window.recaptchaVerifier\n        )\n        .then(async(confirmationResult) => {\n      console.log(confirmationResult,typeof(confirmationResult))\n      window.confirmationResult=confirmationResult\n      setShowModal(true)\n     setLoading(false)\n    }).catch((error) => {\n      // Error; SMS not sent\n      // ...\n      console.log(error)\n      setPasswordError(true)\n    }); \n    }\n   \n  };\n  const otpSubmit = async(otp:string) => {\n    setShowModal(false)\n    // if(confirmationRes!=={})\n    setLoading(true)\n    window.confirmationResult.confirm(otp).then(async(result:any) => {\n      // User signed in successfully.\n      const user = result.user;\n      await setIsLoggedIn(true);\n      // await setUsernameAction(user);\n      setShowAlert1(true)\n      setName(username)\n      setUsername(username)\n      history.push('/login', {direction: 'none'});\n      // ...\n    }).catch((error:any) => {\n      // User couldn't sign in (bad verification code?)\n      // ...\n    });\n  }\n  return (\n    <IonPage id=\"signup-page\">\n      <IonHeader>\n        <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonMenuButton></IonMenuButton>\n          </IonButtons>\n          <IonTitle>Signup</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n\n        <div className=\"login-logo\">\n          <img src=\"data:image/png;base64,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\" alt=\"Ionic logo\" />\n        </div>\n          <form noValidate onSubmit={login}>\n          <IonList className=\"div-with-space\">\n            <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Phone Number</IonLabel>\n              <IonInput name=\"username\" type=\"number\" value={username} spellCheck={false} autocapitalize=\"off\" onIonChange={e => {\n                setUserName(e.detail.value!);\n                setUsernameError(false);\n              }}\n                required>\n              </IonInput>\n            </IonItem>\n\n            {formSubmitted && usernameError && <IonText color=\"danger\">\n              <p className=\"ion-padding-start\">\n                Username is required\n              </p>\n            </IonText>}\n              {/* <IonButton onClick={()=>setName(username)}>ClickME</IonButton>\n              <IonButton onClick={()=>checkData()}>checkME</IonButton> */}\n\n            {/* <IonItem>\n              <IonLabel position=\"stacked\" color=\"primary\">Password</IonLabel>\n              <IonInput name=\"password\" type=\"password\" value={password} onIonChange={e => {\n                setPassword(e.detail.value!);\n                setPasswordError(false);\n              }}>\n              </IonInput>\n            </IonItem> */}\n\n            {formSubmitted && passwordError && <IonText color=\"danger\">\n              <p className=\"ion-padding-start\">\n                Error in code\n              </p>\n            </IonText>}\n          </IonList>\n          <div style={{margin:'10px'}} id=\"recaptcha-container\"></div>\n          <IonRow>\n            <IonCol>\n              <IonButton disabled={loading} type=\"submit\" expand=\"block\" id=\"sign-in-button\">\n   \n                Send OTP</IonButton>\n            </IonCol>\n          </IonRow>\n        </form>\n        <IonModal isOpen={showModal} cssClass='my-custom-class'>\n          <IonContent>\n          <IonToolbar>\n          <IonButtons slot=\"start\">\n            <IonMenuButton></IonMenuButton>\n          </IonButtons>\n          <IonTitle>OTP</IonTitle>\n        </IonToolbar>\n        <IonCard>\n          <IonCardContent>\n            <IonItem>\n              <IonText>\n                +91 {username}\n              </IonText>\n              \n            </IonItem>\n            <IonItem>\n                <IonLabel position=\"stacked\" color=\"primary\">Enter your OTP</IonLabel>\n                <IonInput disabled={loading} name=\"otp\" type=\"number\" value={password} maxlength={1} onIonChange={e => {\n                  setPassword(e.detail.value!);\n                  setPasswordError(false);\n                }}>\n                </IonInput>\n            </IonItem> \n            <IonButton expand=\"block\" onClick={() => otpSubmit(password)}>Submit</IonButton>\n\n          </IonCardContent>\n        </IonCard>\n            \n            </IonContent>\n        <IonAlert\n          isOpen={showAlert1}\n          onDidDismiss={() => {\n            \n            setShowAlert1(false)}}\n          cssClass='my-custom-class'\n          header={'Registration Successfull'}\n          message={'Enter your details to continue'}\n          buttons={['OK']}\n        />\n      </IonModal>\n      </IonContent>\n\n    </IonPage>\n  );\n};\n\nexport default connect<OwnProps, {}, DispatchProps>({\n  mapDispatchToProps: {\n    setIsLoggedIn,\n    setUsername,\n    getUserData\n  },\n  component: Login\n})"]},"metadata":{},"sourceType":"module"}